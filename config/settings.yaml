market:
  symbol: "EURUSD"
  timeframe: "M1"             # master-история, всегда M1
  working_timeframe: "H1"     # рабочий ТФ для снапшотов/обучения
  n_bars_master: 70000

paths:
  master_pattern: "{symbol}_{tf}_master.parquet"
  snapshot_pattern: "{symbol}_{tf}_{role}_snapshot_{start}_{end}.parquet"

#имя счёта / сервер,
#настройки для LIVE,
#параметры RL.

# Выбор источника данных: влияет на директории external/master/snapshots
data_source: "mt5"            # "dukascopy" | "mt5"

data_layout:
  external_root: "data/external"
  master_root: "data/master"
  snapshots_root: "data/snapshots"

sources:
  dukascopy:
    external_dir: "dukascopy"
    master_dir: "dukascopy"
    snapshots_dir: "dukascopy"
  mt5:
    external_dir: "mt5"
    master_dir: "mt5"
    snapshots_dir: "mt5"

dukascopy:
  symbol: null                # если null — использовать market.symbol
  start_year: 2010
  years: 15
  external_dir: "data/external"   # legacy; будет игнорироваться при data_layout/sources
  price_divisor: 100000

mt5:
  symbol: null                 # если null — market.symbol
  ticks_start_utc: "2010-01-01T00:00:00Z"
  chunk_hours: 24              # окно запроса тиков
  empty_chunks_stop: 50        # сколько подряд пустых чанков -> стоп (история закончилась)
  build_m1: true               # строим M1 сразу
  m1_granularity: "month"      # month|year (month проще докачивать)

features:
  window_size: 128
  atr:
    atr_period: 14
  volatility:
    vol_period: 20
  returns:
    short_periods: [1, 5]
    ret_long_period: 5
  spread:
    spread_period: 20

  supertrend:
    enabled: true
    # source:
    source: "mt4_csv"    #   - "python"  : считать ST в Python (текущая реализация), mt4_csv - взять из выгруженного MT4 файла
    mt4_csv_path: "data/master/mt4/EURUSD_H1_master.csv"    #   - "mt4_csv" : брать готовые линии из MT4-выгрузки (рекомендуется для train/test)
    # базовые (дефолтные) параметры SuperTrend
    atr_period: 5
    cci_period: 50
    cci_price: typical
    tfs: [ "H1", "H4", "D1" ] # На каких TF считаем SuperTrend
    outputs:
      supertrend_lines: [ "H1", "H4", "D1" ]  # линии SuperTrend по TF
      cci_value:    # CCI как отдельная фича
        enabled: false
        tfs: [ "H1" ]
      cci_sign:         # знак CCI (-1/0/1 или bool)
        enabled: true
        tfs: [ "H1", "H4", "D1" ]
      diffs:    # разности OHLC - SuperTrend
        enabled: true
        ohlc: [ "open", "high", "low", "close" ]
        tfs: [ "H1", "H4", "D1" ]

  murrey:
    enabled: true
    source: mt4_vg
    period_bars: 64
    include_extremes: true
    tfs: [ "H1", "H4", "D1" ]
    outputs:
      levels: true        # сами уровни 0/8..8/8
      distances: true     # расстояния до ближайших уровней / зон
      zone: true          # murrey_zone
      pos_in_zone: true   # murrey_pos_in_zone

  pipeline: ["atr", "returns", "volatility", "spread", "supertrend", "murrey"]
  default_profile: "name1"

  profiles:
    name1:
      use_atr: true
      use_volatility: true
      use_returns: true
      use_spread: true
      use_supertrend: true
      use_murrey: true
      # Профильные оверрайды (если ≠ дефолта)
      atr_period: 14
      vol_period: 20
      short_periods: [1, 5]
      ret_long_period: 5
      spread_period: 20

      supertrend_atr_period: 5    # если совпадают с дефолтом – можно не указывать
      supertrend_cci_period: 50

      murrey:
        enabled: true
        period_bars: 64
        tfs: [ "H1", "H4"]
        outputs:
          levels: true
          distances: true
          zone: true
          pos_in_zone: true

    name2:
      use_atr: true
      use_volatility: true
      use_returns: true
      use_spread: true
      use_supertrend: true
      use_murrey: true

      atr_period: 21
      vol_period: 30
      short_periods: [1, 5]
      ret_long_period: 10
      spread_period: 20

      supertrend_atr_period: 7
      supertrend_cci_period: 50
